diff --git a/node_modules/@libp2p/kad-dht/dist/src/index.d.ts b/node_modules/@libp2p/kad-dht/dist/src/index.d.ts
index a8a01b8..2b6d186 100644
--- a/node_modules/@libp2p/kad-dht/dist/src/index.d.ts
+++ b/node_modules/@libp2p/kad-dht/dist/src/index.d.ts
@@ -495,6 +495,10 @@ export interface KadDHTInit {
      * Record validators
      */
     validators?: Validators;
+    /**
+     * Optional version-aware update validator.
+     */
+    validateUpdate?: (key: Uint8Array, existing: Uint8Array, incoming: Uint8Array) => Promise<void>;
     /**
      * How often to query our own PeerId in order to ensure we have a
      * good view on the KAD address space local to our PeerId
diff --git a/node_modules/@libp2p/kad-dht/src/index.ts b/node_modules/@libp2p/kad-dht/src/index.ts
index 4f556be..12e2f78 100644
--- a/node_modules/@libp2p/kad-dht/src/index.ts
+++ b/node_modules/@libp2p/kad-dht/src/index.ts
@@ -554,6 +554,13 @@ export interface KadDHTInit {
    */
   validators?: Validators
 
+  /**
+   * Optional version-aware update validator. Called on PUT_VALUE when a record
+   * already exists for the key. Throws to reject the incoming record (e.g. if
+   * its version is lower than the existing one).
+   */
+  validateUpdate?: (key: Uint8Array, existing: Uint8Array, incoming: Uint8Array) => Promise<void>
+
   /**
    * How often to query our own PeerId in order to ensure we have a
    * good view on the KAD address space local to our PeerId
diff --git a/node_modules/@libp2p/kad-dht/src/kad-dht.ts b/node_modules/@libp2p/kad-dht/src/kad-dht.ts
index 6d9aded..4bf2b17 100644
--- a/node_modules/@libp2p/kad-dht/src/kad-dht.ts
+++ b/node_modules/@libp2p/kad-dht/src/kad-dht.ts
@@ -266,6 +266,7 @@ export class KadDHT extends TypedEventEmitter<PeerDiscoveryEvents> implements Ka
       providers: this.providers,
       peerRouting: this.peerRouting,
       validators: this.validators,
+      validateUpdate: init.validateUpdate,
       logPrefix,
       metricsPrefix,
       datastorePrefix,
diff --git a/node_modules/@libp2p/kad-dht/src/rpc/handlers/put-value.ts b/node_modules/@libp2p/kad-dht/src/rpc/handlers/put-value.ts
index 156e65d..3d0a79c 100644
--- a/node_modules/@libp2p/kad-dht/src/rpc/handlers/put-value.ts
+++ b/node_modules/@libp2p/kad-dht/src/rpc/handlers/put-value.ts
@@ -12,6 +12,7 @@ export interface PutValueHandlerInit {
   validators: Validators
   logPrefix: string
   datastorePrefix: string
+  validateUpdate?: (key: Uint8Array, existing: Uint8Array, incoming: Uint8Array) => Promise<void>
 }
 
 export interface PutValueHandlerComponents {
@@ -24,17 +25,19 @@ export class PutValueHandler implements DHTMessageHandler {
   private readonly validators: Validators
   private readonly log: Logger
   private readonly datastorePrefix: string
+  private readonly validateUpdate?: (key: Uint8Array, existing: Uint8Array, incoming: Uint8Array) => Promise<void>
 
-  constructor (components: PutValueHandlerComponents, init: PutValueHandlerInit) {
-    const { validators } = init
+  constructor(components: PutValueHandlerComponents, init: PutValueHandlerInit) {
+    const { validators, validateUpdate } = init
 
     this.components = components
     this.log = components.logger.forComponent(`${init.logPrefix}:rpc:handlers:put-value`)
     this.datastorePrefix = `${init.datastorePrefix}/record`
     this.validators = validators
+    this.validateUpdate = validateUpdate
   }
 
-  async handle (peerId: PeerId, msg: Message): Promise<Message> {
+  async handle(peerId: PeerId, msg: Message, ): Promise<Message> {
     const key = msg.key
     this.log('%p asked us to store value for key %b', peerId, key)
 
@@ -47,11 +50,26 @@ export class PutValueHandler implements DHTMessageHandler {
 
     try {
       const deserializedRecord = Libp2pRecord.deserialize(msg.record)
-
       await verifyRecord(this.validators, deserializedRecord)
-
       deserializedRecord.timeReceived = new Date()
       const recordKey = bufferToRecordKey(this.datastorePrefix, deserializedRecord.key)
+
+      // NEW: check existing record before overwriting
+      if (this.validateUpdate != null) {
+        try {
+          const existingRaw = await this.components.datastore.get(recordKey)
+          const existing = Libp2pRecord.deserialize(existingRaw)
+          // throws if incoming version < existing version
+          await this.validateUpdate(deserializedRecord.key, existing.value, deserializedRecord.value)
+        } catch (err: any) {
+          if (err.message === 'stale record rejected') {
+            this.log('rejected stale record for %b (version too old)', key)
+            return msg  // reject the PUT, keep existing record
+          }
+          // datastore.get threw "not found" â€” no existing record, continue to store
+        }
+      }
+
       await this.components.datastore.put(recordKey, deserializedRecord.serialize().subarray())
       this.log('put record for %b into datastore under key %k', key, recordKey)
     } catch (err: any) {
diff --git a/node_modules/@libp2p/kad-dht/src/rpc/index.ts b/node_modules/@libp2p/kad-dht/src/rpc/index.ts
index a9a1491..7c83c35 100644
--- a/node_modules/@libp2p/kad-dht/src/rpc/index.ts
+++ b/node_modules/@libp2p/kad-dht/src/rpc/index.ts
@@ -26,6 +26,7 @@ export interface RPCInit {
   providers: Providers
   peerRouting: PeerRouting
   validators: Validators
+  validateUpdate?: (key: Uint8Array, existing: Uint8Array, incoming: Uint8Array) => Promise<void>
   logPrefix: string
   metricsPrefix: string
   datastorePrefix: string
